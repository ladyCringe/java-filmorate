# Filmorate

Filmorate ‚Äî –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —Ñ–∏–ª—å–º–æ–≤.
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç: —Å—Ç–∞–≤–∏—Ç—å –ª–∞–π–∫–∏ —Ñ–∏–ª—å–º–∞–º, –¥–æ–±–∞–≤–ª—è—Ç—å –¥—Ä—É–∑–µ–π, —Ç–∞–∫–∂–µ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤.

## –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:

- Java 21
- Spring Boot
- Lombok
- In-memory —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (Map)
- REST API

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **Controller** ‚Äî REST-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- **Service** ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- **Storage** ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ (–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –≤ –ø–∞–º—è—Ç–∏)

---

## –ú–æ–¥–µ–ª–∏:

### 1) –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `id`, email, –ª–æ–≥–∏–Ω, –∏–º—è, –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è
- –§—É–Ω–∫—Ü–∏–∏: –¥–æ–±–∞–≤–ª—è—Ç—å –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –¥—Ä—É–∑—å—è
- –î—Ä—É–∂–±–∞ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

### 2) –§–∏–ª—å–º—ã

- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `id`, –Ω–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ, –¥–∞—Ç–∞ —Ä–µ–ª–∏–∑–∞, –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Ä–µ–π—Ç–∏–Ω–≥ MPA
- –°–æ–¥–µ—Ä–∂–∞—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∂–∞–Ω—Ä–æ–≤
- –°–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ –ª–∞–π–∫–æ–≤ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –°–æ–¥–µ—Ä–∂–∞—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–µ–∂–∏—Å—Å–µ—Ä–æ–≤

---

## üîó –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

![ER Diagram](./database.png)

### –¢–∞–±–ª–∏—Ü—ã:

| –¢–∞–±–ª–∏—Ü–∞         | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                        |
|-----------------|---------------------------------------------------|
| `Users`         | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏                                      |
| `Friendships`   | –°–≤—è–∑—å –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å —Ñ–ª–∞–≥–æ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è |
| `Films`         | –§–∏–ª—å–º—ã                                            |
| `Likes`         | –ö—Ç–æ –ª–∞–π–∫–Ω—É–ª –∫–∞–∫–æ–π —Ñ–∏–ª—å–º                           |
| `Mpa_Ratings`   | –†–µ–π—Ç–∏–Ω–≥–∏ MPA                                      |
| `Genres`        | –ñ–∞–Ω—Ä—ã                                             |
| `Film_Genres`   | –°–≤—è–∑—å –º–µ–∂–¥—É —Ñ–∏–ª—å–º–∞–º–∏ –∏ –∂–∞–Ω—Ä–∞–º–∏                    |
| `Reviews`       | –û—Ç–∑—ã–≤—ã                                            |
| `Review_likes`  | –¢–∞–±–ª–∏—á–∫–∞ –ª–∞–π–∫–æ–≤ –∫ –æ—Ç–∑—ã–≤–∞–º                         |
| `Directors`     | –†–µ–∂–∏—Å—Å—ë—Ä—ã                                         |
| `Film_Director` | –°–≤—è–∑—å –º–µ–∂–¥—É —Ñ–∏–ª—å–º–∞–º–∏ –∏ —Ä–µ–∂–∏—Å—Å–µ—Ä–∞–º–∏                |
| `Feed`          | –õ–µ–Ω—Ç–∞ –Ω–æ–≤–æ—Å—Ç–µ–π: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å - —Å–æ–±—ã—Ç–∏–µ            |

---

## –ü—Ä–∏–º–µ—Ä—ã SQL-–∑–∞–ø—Ä–æ—Å–æ–≤

**–¢–æ–ø-10 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤:**

```sql
SELECT f.*, COUNT(l.user_id) AS likes
FROM films f
LEFT JOIN likes l ON f.id = l.film_id
GROUP BY f.id
ORDER BY likes DESC
LIMIT 10;
```

**–ü–æ–ª—É—á–µ–Ω–∏–µ –∂–∞–Ω—Ä–æ–≤ —Ñ–∏–ª—å–º–∞ –ø–æ –µ–≥–æ ID:**

```sql
SELECT g.*
FROM genres g
JOIN film_genres fg ON g.id = fg.genre_id
WHERE fg.film_id = ?;
```

**–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥—Ä—É–∑–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**

```sql
SELECT u.*
FROM users u
JOIN friendships f ON u.id = f.friend_id
WHERE f.user_id = ? AND f.confirmed = true;
```

